{% load static %}

<!DOCTYPE html>
<html>
<head>
<title>Frizerski salon Hasko</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

      <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
      <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
      <!--ICON -->
      <link rel="icon" type="image/x-icon" href="{% static 'images/icon.png' %}">
      <link rel="apple-touch-icon"  href="{% static 'images/icon.png' %}" sizes="120x120">
      <link rel="manifest" href="{% static 'images/manifest.json' %}">

      <!--
          TIK TOK ICON
      -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.css">
      <!--Flat Picker-->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
      <meta name="viewport" content="width=device-width, initial-scale=0.95">

      {% comment %} Hover Effect on //cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css {% endcomment %}
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/imagehover.css/2.0.0/css/imagehover.min.css">
      <link rel="stylesheet" href="/static/css/style.css">
      <link rel="stylesheet" href="{% static 'css/gallery.css' %}">

      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	<script type="text/javascript">

		function getCookie(name) {
		    var cookieValue = null;
		    if (document.cookie && document.cookie !== '') {
		        var cookies = document.cookie.split(';');
		        for (var i = 0; i < cookies.length; i++) {
		            var cookie = cookies[i].trim();
		            // Does this cookie string begin with the name we want?
		            if (cookie.substring(0, name.length + 1) === (name + '=')) {
		                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
		                break;
		            }
		        }
		    }
		    return cookieValue;
		}


		function uuidv4() {
		  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
		    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
		    return v.toString(16);
		  });
		}




		let device = getCookie('device')

		if (device == null || device == undefined){
			device = uuidv4()
		}

		document.cookie ='device=' + device + ";domain=;path=/"

	</script>
	<meta name="google-site-verification" content="bWB3iu8-2a7X6XY7XdOSpxpak00vazWInrkizNydAss" />
</head>
<body>

<div class="fixed-bottom-nav">
    <div class="nav-item active" onclick="showPage('home-page')">
        <i class="fa fa-home"></i>
        <span>Home</span>
    </div>
    <div class="nav-item" onclick="showPage('profile-page')">
        <i class="fa fa-user"></i>
        <span>Profile</span>
    </div>
    <div class="nav-item" onclick="showPage('notifications-page')">
        <i class="fa fa-bell"></i>
        <span>Notifications</span>
    </div>
    <div class="nav-item" onclick="showPage('appointments-page')">
        <i class="fa fa-calendar"></i>
        <span>Appointments</span>
    </div>
</div>

<!-- Navbar (sit on top) -->
<div class="w3-top">
  <div class="w3-bar w3-white w3-card" id="myNavbar">
    <a href="{% url "zakazi" %}" class="w3-bar-item w3-button w3-wide">
      FRIZERSKI SALON <strong> HASKO</strong>
   </a>
    <!-- Right-sided navbar links -->
    <div class="w3-right w3-hide-small  w3-hide-medium">
    {% if viewname == "zakazi" %}
      <a href="{% url "termin" %}" class="w3-bar-item w3-button"><i class="fa fa-arrow-right"></i> ZAKAŽI</a>
      <a href="#team" class="w3-bar-item w3-button"><i class="fa fa-user"></i> NAŠ TIM</a>
      <a href="{% url "galerija" %}" class="w3-bar-item w3-button"><i class="fa fa-th"></i> KATALOG</a>
      <a href="#pricing" class="w3-bar-item w3-button"><i class="fa fa-usd"></i> USLUGE</a>
      <a href="#contact" class="w3-bar-item w3-button"><i class="fa fa-envelope"></i> KONTAKT</a>
      {% if user.is_authenticated %}
      <a href="{% url 'zafrizera' %}" class="w3-bar-item w3-button"><i class="fa fa-calendar" aria-hidden="true"></i> TERMINI</a>
      <a href="{% url 'user_logout' %}" class="w3-bar-item w3-button"><i class="fa fa-sign-out" aria-hidden="true"></i> ODJAVI SE</a>
      {% else %}
      <a href="{% url 'user_logout' %}" class="w3-bar-item w3-button"><i class="fa fa-sign-in" aria-hidden="true"></i> PRIJAVI SE</a>
      {% endif %}
    {%else %}
        <a href="{% url "zakazi" %}" class="w3-bar-item w3-button"><i class="fa fa-arrow-right"></i> POČETNA</a>
    {% endif %}
    </div>
    <!-- Hide right-floated links on small screens and replace them with a menu icon -->

    <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large" onclick="w3_open()">
      <i class="fa fa-bars"></i>
    </a>
    {% if user.is_authenticated %}
    <a href="{% url 'zafrizera' %}" class="w3-bar-item w3-button w3-right w3-hide-large"><i class="fa fa-calendar" aria-hidden="true"></i> </a>
    {% endif %}
  </div>
</div>

<!-- Sidebar on small screens when clicking the menu icon -->
<nav class="w3-sidebar w3-bar-block w3-black w3-card w3-animate-left w3-hide-large" style="display:none" id="mySidebar">
  {% if viewname == "zakazi" %}
    <a href="javascript:void(0)" onclick="w3_close()" class="w3-bar-item w3-button w3-large w3-padding-16">Zatvori ×</a>
  
    <a href="{% url "termin" %}" onclick="w3_close()" class="w3-bar-item w3-button">ZAKAŽI</a>
    <a href="#team" onclick="w3_close()" class="w3-bar-item w3-button">NAŠ TIM</a>
    <a href="{% url "galerija" %}" onclick="w3_close()" class="w3-bar-item w3-button">KATALOG</a>
    <a href="#pricing" onclick="w3_close()" class="w3-bar-item w3-button">USLUGE</a>
    <a href="#contact" onclick="w3_close()" class="w3-bar-item w3-button">KONTAKT</a>
    <a href="{% url 'user_logout' %}" class="w3-bar-item w3-button" style="position: absolute; bottom: 0;"><i class="fa fa-sign-out" aria-hidden="true"></i> ODJAVI SE</a>

  {% else %}
     <a href="{% url "zakazi" %}" onclick="w3_close()" class="w3-bar-item w3-button">POČETNA</a>
  {% endif %}
   
  {% if user.is_authenticated %}
     <a href="{% url 'zafrizera' %}" class="w3-bar-item w3-button"><i class="fa fa-calendar" aria-hidden="true"></i> TERMINI</a>
     <a href="{% url 'user_logout' %}" class="w3-bar-item w3-button" style="position: absolute; bottom: 0;"><i class="fa fa-sign-out" aria-hidden="true" ></i> ODJAVI SE</a>
  {% else %}
     <a href="{% url 'user_logout' %}" class="w3-bar-item w3-button" style="position: absolute; bottom: 0;"><i class="fa fa-sign-out" aria-hidden="true"></i> PRIJAVI SE</a>
  {% endif %}

</nav>
{% block content %}



{% endblock %}

<!-- Footer -->
<footer class="w3-center w3-black w3-padding-64">

    <div class="container">
      <di class="row ">
        <div class="col-sm " style="padding-right: 150px ;">
          <h3 class="d-flex justify-content-start "><b>GDE SE NALAZIMO</b></h3>
          <br>
          <p class="text-left" >-Frizerski salon radi radnim danima i vikendom na zakazivanje termina. 
            <br>-Zakažite termin putem sajta online i pozivom ili sms poruke.</p>
            <br>
            <p class="d-flex justify-content-start"><i class="fa fa-map-marker fa-fw w3-xxlarge w3-margin-right"></i>Generala Zivkovica 183 Novi Pazar, Srbija</p>
            <p class="d-flex justify-content-start"><i class="fa fa-phone fa-fw w3-xxlarge w3-margin-right"></i> Phone: +381 64 2172921</p>
            <p class="d-flex justify-content-start"><i class="fab fa-envelope fa-fw w3-xxlarge w3-margin-right"> </i> Email: hasko83@gmail.com</p>
            
        </div>
        <div class="col-sm" style="padding-right: 150px ;">
          <h3 class="d-flex justify-content-start"><b>KADA RADIMO</b></h3>
          <br>
            <h4 class="d-flex justify-content-start">PON-ČET / SUB-NED:</h4>  
            <p class="d-flex justify-content-start"> od 10:00 do 19:00</p>
            <h4 class="d-flex justify-content-start"> Petkom ne radimo !
              <br/>
              <br/>
              <br/>
              <h4 class="d-flex justify-content-start"><a href="{% url "termin" %}">Kliknite da zakazete</a></h4>
        </div>
        <div class="col-sm">        
          <h3 class="d-flex justify-content-start"><b>PRATITE NAS</b></h3>
          <br>
  
            <br>
            <a href="https://www.instagram.com/frizerski_salon_hasko/?igshid=YmMyMTA2M2Y=" class="d-flex justify-content-start"><i style="font-size: 2.73em; padding-right: 20px;" class="fa fa-instagram w3-hover-opacity"></i>  <p>  Instagram </p></a>
            <br>
            <a href="https://youtube.com/@hasredin1983" class="d-flex justify-content-start"><i style="font-size: 2.73em; padding-right: 20px;" class="fa fa-youtube-play w3-hover-opacity"></i>  <p>  Youtube </p></a>
            <br>
            <a href="https://www.facebook.com/muvehid.beciro?mibextid=ZbWKwL" class="d-flex justify-content-start"><i style="font-size: 2.73em; padding-right: 20px;" class="fa fa-facebook-official w3-hover-opacity"></i>  <p>  Facebook </p></a>
            <br>
            <a href="https://vm.tiktok.com/ZMFjSnoWv/" class="d-flex justify-content-start"><i style="font-size: 2.73em; padding-right: 20px;" class="fab fa-tiktok w3-hover-opacity"></i>  <p>  TikTok </p></a>
        </div>
      </div>
    </div>
  
    {% comment %} <a href="#home" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>Na vrh</a>
    <div class="w3-xlarge w3-section">
      <i class="fa fa-facebook-official w3-hover-opacity"></i>
      <i style="font-size: 1.73em;" class="fa fa-instagram w3-hover-opacity"></i>
      <i class="fa fa-snapchat w3-hover-opacity"></i>
      <i class="fa fa-youtube-play w3-hover-opacity"></i>
      <i class="fa fa-twitter w3-hover-opacity"></i>
      <i class="fa fa-linkedin w3-hover-opacity"></i>
    </div> {% endcomment %}
    <!-- <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p> -->
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
      
  <script>
  // Modal Image Gallery
  function onClick(element) {
    document.getElementById("img01").src = element.src;
    document.getElementById("modal01").style.display = "block";
    var captionText = document.getElementById("caption");
    captionText.innerHTML = element.alt;
  }
  
  
  // Toggle between showing and hiding the sidebar when clicking the menu icon
  var mySidebar = document.getElementById("mySidebar");
  
  function w3_open() {
    if (mySidebar.style.display === 'block') {
      mySidebar.style.display = 'none';
    } else {
      mySidebar.style.display = 'block';
    }
  }
  
  // Close the sidebar with the close button
  function w3_close() {
      mySidebar.style.display = "none";
  }
  </script>
  
  <script>
    document.getElementsByName("datum")[0].setAttribute('min', "{{godina}}-{{mesec}}-{{dan}}");
  </script>
  <script >
    //This is test
    const datum = document.getElementById("datum");
    const usluga = document.getElementById("usluga");
    const frizer = document.getElementById("frizer");
    const btn = document.getElementById("first_form_button")

    var duration = "{{ duration }}"
    console.log(duration*1000)
    var data = JSON.parse ("{{filtered_list | escapejs}}");
    console.log(data)

    var compTermin = new Date()
    var lis = document.getElementById("id_vreme").getElementsByTagName("option");
    var id_vreme = document.getElementById("id_vreme")
    var potvrdi_form = document.getElementById("potvrdi-form")
    var za_brisanje = []
    

    //Iterate over all possible termins
    for (let i =0; i <lis.length; i++){

        const vreme_python = "{{ godina }},{{ mesec }},{{ dan }}".split(",")
        var danas = new Date()

        var b = lis[i].value.split(":")
        var term = new Date(vreme_python[0],vreme_python[1],vreme_python[2],b[0],b[1],b[2])
        console.log("Termin =",  term)

        //To be scheduled + duration to tetermin if there is enough time
        var porduzeni = new Date(term.getTime() + duration * 1000)

        //Iterate over all appoinments from database
        for (item in data){
          var c = data[item]["pocetak"].split(":")
          var zauzet_pocetak = new Date(vreme_python[0],vreme_python[1],vreme_python[2],c[0],c[1],c[2])

          var d = data[item]["kraj"].split(":")
          var zauzet_kraj = new Date(vreme_python[0],vreme_python[1],vreme_python[2],d[0],d[1],d[2])
          //Prevent todays expired termin of beeing selected
          if (datum.value == danas.getDate()){            
            if (danas.getTime() > term.getTime()){

              //check if we have already deleted that item
              if (!za_brisanje.includes(lis[i])){

                //appent to list for deleting
                za_brisanje.push(lis[i]);
              }
            }
          }
          if (porduzeni  > zauzet_pocetak.getTime()  && term < zauzet_kraj){
              lis[i].style.display = "none";
              if (!za_brisanje.includes(lis[i])){
                za_brisanje.push(lis[i]);
              }
          }
      }

  }
  //deleting taken termins
  za_brisanje.forEach(zaBrisanje);
  function zaBrisanje(el){
      el.remove()
      console.log(el)
  }
  if (lis.length === 0 ) {
    potvrdi_form.remove();
    document.getElementById("nema-termina").style.display = "block"
  }
</script>
<script>
    function showPage(pageId) {
        // Hide all pages
        const pages = document.querySelectorAll('.page');
        pages.forEach(page => {
            page.classList.remove('active');
        });

        // Show selected page
        document.getElementById(pageId).classList.add('active');

        // Update active nav item
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
            item.classList.remove('active');
        });

        // Find the clicked nav item and make it active
        const clickedItem = Array.from(navItems).find(item => {
            return item.getAttribute('onclick').includes(pageId);
        });

        if (clickedItem) {
            clickedItem.classList.add('active');
        }
    }
</script>
  </body>
  </html>
  
